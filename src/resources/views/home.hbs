<section style="background-color: #eee;">
    <!-- carousel-->
    <div class="text-center container-fluid py-5">
        <div id="carouselExampleIndicators" class="carousel slide">
            <div class="carousel-indicators">
                <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
                <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="1" aria-label="Slide 2"></button>
                <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="2" aria-label="Slide 3"></button>
            </div>
            <div class="carousel-inner">
                <div class="carousel-item active">
                <img src="img/img-carousel4.jpg" class="d-block w-100" alt="..." style="height: 37em;">
                </div>
                <div class="carousel-item">
                <img src="img\cac-dong-nike-02.webp" class="d-block w-100" alt="..." style="height: 37em;">
                </div>
                <div class="carousel-item">
                <img src="img/img-carousel2.webp" class="d-block w-100" alt="..." style="height: 37em;">
                </div>
            </div>
            <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Previous</span>
            </button>
            <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Next</span>
            </button>
        </div>
    </div>
    <!-- New shoes-->
    <div class="text-center container py-5">
    <h4 class="mt-2 mb-3"><strong>New Shoes</strong></h4>
        <div class="row">
            {{#each demos}}               
                <div class="col-sm-6 col-lg-4">
                    <div class="card card-demo-item">
                        <div class="hover-overlay">  
                            <a href="/demos/{{this.slug}}">
                                <img src="{{this.image}}" class="card-img-top" alt="{{this.name}}">
                            </a>
                        </div>
                        <div class="card-body">
                            <a href="/demos/{{this.slug}}" style="text-decoration: none; color: black;">
                                <h5 class="card-title">{{this.name}}</h5>
                            </a>
                            <p class="card-text">{{this.cost}}$</p>                        
                        </div>
                    </div>
                </div>            
            {{/each}}
        </div>
    </div>
    <!-- about us-->
    <div>
        <section class="py-3 py-md-5">
        <div class="container">
            <div class="row gy-3 gy-md-4 gy-lg-0 align-items-lg-center">
            <div class="col-12 col-lg-6">
                <img class="img-fluid rounded" loading="lazy" src="img/about us.jpg" alt="About 2">
            </div>
            <div class="col-12 col-lg-6">
                <div class="row justify-content-xl-center">
                <div class="col-12 col-xl-10">
                    <h2 class="mb-3">Why Choose Us?</h2>
                    <p class="lead fs-4 mb-3 mb-xl-5">“Our function is to provide knowledge and insight. We are the global repository for the science of human performance and potential” quotes Matthew Nurse, the Senior Director of the Nike Explore Team Sport Research Lab.</p>
                    <div class="d-flex align-items-center mb-3">
                    <div class="me-3 text-primary">
                        <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="currentColor" class="bi bi-check-circle-fill" viewBox="0 0 16 16">
                        <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z" />
                        </svg>
                    </div>
                    <div>
                        <p class="fs-5 m-0">Product innovation</p>
                    </div>
                    </div>
                    <div class="d-flex align-items-center mb-3">
                    <div class="me-3 text-primary">
                        <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="currentColor" class="bi bi-check-circle-fill" viewBox="0 0 16 16">
                        <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z" />
                        </svg>
                    </div>
                    <div>
                        <p class="fs-5 m-0">The digital connection</p>
                    </div>
                    </div>
                    <div class="d-flex align-items-center mb-4 mb-xl-5">
                    <div class="me-3 text-primary">
                        <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="currentColor" class="bi bi-check-circle-fill" viewBox="0 0 16 16">
                        <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z" />
                        </svg>
                    </div>
                    <div>
                        <p class="fs-5 m-0">New retail concepts.</p>
                    </div>
                    </div>
                    <button type="button" class="btn bsb-btn-xl btn-outline-primary rounded-pill"><a href="/search" style="text-decoration: none; color: black;">Connect Now</a></button>
                </div>
                </div>
            </div>
            </div>
        </div>
        </section>
    </div>
    <!-- about our blog-->
    <section class="py-3 py-md-5 py-xl-8">
    <div class="container">
        <div class="row gy-3 gy-md-4 gy-lg-0 align-items-lg-center">
        <div class="col-12 col-lg-6 col-xl-5">
            <img class="img-fluid rounded" loading="lazy" src="/img/city.jpg" alt="">
        </div>
        <div class="col-12 col-lg-6 col-xl-7">
            <div class="row justify-content-xl-center">
            <div class="col-12 col-xl-11">
                <h2 class="h1 mb-3">About Our Blog</h2>
                <p class="lead fs-4 text-secondary mb-3">We help people to build incredible brands and superior products. Our perspective is to furnish outstanding captivating services.</p>
                <p class="mb-5">Nullam gravida orci ac luctus molestie. Fusce finibus congue erat, non aliquam magna tincidunt at. Aenean lacinia arcu ex, sed pharetra nibh porta a. Curabitur vel consequat nibh, ac interdum nisl. Nunc pulvinar nec massa vitae sollicitudin.</p>
                <div class="row gy-4 gy-md-0 gx-xxl-5X">
                <div class="col-12 col-md-6">
                    <div class="d-flex">
                    <div class="me-4 text-primary">
                        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="currentColor" class="bi bi-gear-fill" viewBox="0 0 16 16">
                        <path d="M9.405 1.05c-.413-1.4-2.397-1.4-2.81 0l-.1.34a1.464 1.464 0 0 1-2.105.872l-.31-.17c-1.283-.698-2.686.705-1.987 1.987l.169.311c.446.82.023 1.841-.872 2.105l-.34.1c-1.4.413-1.4 2.397 0 2.81l.34.1a1.464 1.464 0 0 1 .872 2.105l-.17.31c-.698 1.283.705 2.686 1.987 1.987l.311-.169a1.464 1.464 0 0 1 2.105.872l.1.34c.413 1.4 2.397 1.4 2.81 0l.1-.34a1.464 1.464 0 0 1 2.105-.872l.31.17c1.283.698 2.686-.705 1.987-1.987l-.169-.311a1.464 1.464 0 0 1 .872-2.105l.34-.1c1.4-.413 1.4-2.397 0-2.81l-.34-.1a1.464 1.464 0 0 1-.872-2.105l.17-.31c.698-1.283-.705-2.686-1.987-1.987l-.311.169a1.464 1.464 0 0 1-2.105-.872l-.1-.34zM8 10.93a2.929 2.929 0 1 1 0-5.86 2.929 2.929 0 0 1 0 5.858z" />
                        </svg>
                    </div>
                    <div>
                        <h4 class="mb-3">Versatile Brand</h4>
                        <p class="text-secondary mb-0">We are crafting a digital method that subsists life across all mediums.</p>
                    </div>
                    </div>
                </div>
                <div class="col-12 col-md-6">
                    <div class="d-flex">
                    <div class="me-4 text-primary">
                        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="currentColor" class="bi bi-fire" viewBox="0 0 16 16">
                        <path d="M8 16c3.314 0 6-2 6-5.5 0-1.5-.5-4-2.5-6 .25 1.5-1.25 2-1.25 2C11 4 9 .5 6 0c.357 2 .5 4-2 6-1.25 1-2 2.729-2 4.5C2 14 4.686 16 8 16Zm0-1c-1.657 0-3-1-3-2.75 0-.75.25-2 1.25-3C6.125 10 7 10.5 7 10.5c-.375-1.25.5-3.25 2-3.5-.179 1-.25 2 1 3 .625.5 1 1.364 1 2.25C11 14 9.657 15 8 15Z" />
                        </svg>
                    </div>
                    <div>
                        <h4 class="mb-3">Digital Agency</h4>
                        <p class="text-secondary mb-0">We believe in innovation by merging primary with elaborate ideas.</p>
                    </div>
                    </div>
                </div>
                <button type="button" class="btn bsb-btn-xl btn-outline-primary rounded-pill mt-4"><a href="/blogs" style="text-decoration: none; color: black;">Read More Our Blog Now</a></button>
                </div>
            </div>
            </div>
        </div>
        </div>
    </div>
    </section>
    <div>
    </div>
<div id="boxtochat" class="">
    <button class="chatbot-toggler">
        <span class="material-symbols-outlined">mode_comment</span>
        <span class="material-symbols-outlined">close</span>
    </button>
    <div class="chatbot">
        <header>
            <h2>Chatbot</h2>
            <span class="close-btn material-symbols-outlined">close</span>
        </header>
        <ul class="chatbox">
            <li class="chat incoming">
                <span class="material-symbols-outlined">smart_toy</span>
                <p>Hi there <br> How can I help you today?</p>
            </li>
        </ul>
        <div class="chat-input">
            <textarea placeholder="enter a message..." required></textarea>
            <span id="send-btn" class="material-symbols-outlined">send</span>
        </div>
    </div>
</div>
<div>
{{> footer}}
</div>
<script>
    const chatInput = document.querySelector(".chat-input textarea");
    const sendChatBtn = document.querySelector(".chat-input span");
    const chatbox = document.querySelector(".chatbox");
    const chatbotToggler = document.querySelector(".chatbot-toggler");
    const result = document.getElementById("boxtochat");
    const chatbotCloseBtn = document.querySelector(".close-btn");

    let userMessage;
    const API_KEY = "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";

    const inputInitHeight = chatInput.scrollHeight;

    const createChatLi = (message, className) => {
        //create a chat <li> element with passed message and className
        const chatLi = document.createElement("li");
        chatLi.classList.add("chat", className);
        let chatContent = className === "outgoing" ? `<p></p>` : `<span class="material-symbols-outlined">smart_toy</span><p></p>`;
        chatLi.innerHTML = chatContent;
        chatLi.querySelector("p").textContent = message;
        return chatLi;
    }

    const generateResponse = (incomingChatLi) =>{
        const API_URL = "https://api.openai.com/v1/chat/completions";
        const messageElement = incomingChatLi.querySelector("p");

        const requestOptions = {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
                "Authorization": `Bearer ${API_KEY}`
            },
            body: JSON.stringify({
                model: "gpt-3.5-turbo",
                messages: [
                {
                    role: "user",
                    content: userMessage
                }
                ]
            })
        }

        fetch(API_URL, requestOptions).then(res => res.json()).then(data => {
            messageElement.textContent = data.choices[0].message.content;
        }).catch((error) => {
            messageElement.textContent = "Oops! Something went wrong. Please try again.";
        }).finally(() => chatbox.scrollTo(0, chatbox.scrollHeight))
    }
    const handleChat = () => {
        userMessage = chatInput.value.trim();
        if(!userMessage) return;
        chatInput.value = "";
        chatInput.style.height = `${inputInitHeight}px`;

        //Append the user's message to the chatbox
        chatbox.appendChild(createChatLi(userMessage, "outgoing"));
        chatbox.scrollTo(0, chatbox.scrollHeight);

        setTimeout(() => {
            //Display "Thinking..." message while waiting for the response
            const incomingChatLi = createChatLi("Thinking...", "incoming")
            chatbox.appendChild(incomingChatLi);
            chatbox.scrollTo(0, chatbox.scrollHeight);
            generateResponse(incomingChatLi);
        }, 600);
    }

    chatInput.addEventListener("input", () => {
        //Adjust the height of the input textarea based on its content
        chatInput.style.height = `${inputInitHeight}px`;
        chatInput.style.height = `${chatInput.scrollHeight}px`;
    })

    chatInput.addEventListener("keydown", (e) => {
        //if Enter key is pressed without Shift key and the window width
        //is greater than 800px, handle the chat
        if(e.key === "Enter" && !e.shiftKey && window.innerWidth > 800){
            e.preventDefault();
            handleChat();
            console.log("key enter is press");
        }
    })

    sendChatBtn.addEventListener("click", handleChat);
    chatbotCloseBtn.addEventListener("click", () => result.classList.remove("show-chatbot"));
    chatbotToggler.addEventListener("click", () => result.classList.toggle("show-chatbot"));
</script>
